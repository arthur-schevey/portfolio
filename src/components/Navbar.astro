---
import { Icon } from 'astro-icon/components';
import ThemeSwitch from './ThemeSwitch.astro';
---

<!-- Navbar is sticky -->
<div class="daisy-navbar rounded-box bg-base-300 mb-8 sticky top-6 z-50 shadow-md">

    <!-- Nav links -->
    <div class="flex-1">
      <a class="daisy-btn daisy-btn-ghost text-neutral text-2xl navlink" href="#">
        <Icon name="bi:code-slash" />
      </a>
      <a class="daisy-btn daisy-btn-ghost text-base font-bold navlink" href="#projects">Projects</a>
      <a class="daisy-btn daisy-btn-ghost text-base font-bold navlink" href="#experience">Work Experience</a>
      <a class="daisy-btn daisy-btn-ghost text-base font-bold navlink" href="#writeups">Writeups</a>
    </div>

    <!-- Social links + theme change -->
    <div class="flex">
      <a
        class="daisy-btn daisy-btn-square daisy-btn-ghost text-xl"
        href="https://github.com/arthur-schevey"
        target="_blank"
        rel="noopener noreferrer"
      >
        <Icon name="bi:github" />
      </a>

      <a
        class="daisy-btn daisy-btn-square daisy-btn-ghost text-xl"
        href="https://www.linkedin.com/in/arthur-schevey/"
        target="_blank"
        rel="noopener noreferrer"
      >
        <Icon name="bi:linkedin" />
      </a>
      
      <div class="daisy-divider daisy-divider-horizontal m-0"></div>
      
      <ThemeSwitch/>
    </div>
</div>

<script>
  const navLinks = document.querySelectorAll(".daisy-navbar .navlink");
  const sections = document.querySelectorAll("section[id]");  
  const offset = 150;

  function onScroll() {
    const scrollY = window.scrollY;
    let activeId: string | null = null;

    for (const section of sections) {
      const top = (section as HTMLElement).offsetTop;
      if (scrollY >= top - offset) { 
        activeId = section.id;
      }
    }

    navLinks.forEach((link) => {
      if (activeId) {
        // match section links
        link.classList.toggle("bg-primary", link.getAttribute("href") === `#${activeId}`);
      } else {
        // top of page â†’ home link
        link.classList.toggle("bg-primary", link.getAttribute("href") === "#");
      }
    });
  }

  window.addEventListener("scroll", onScroll);
  window.addEventListener("load", onScroll); // highlight correct link on page load
</script>
